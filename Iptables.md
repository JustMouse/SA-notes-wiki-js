---
title: Iptables
description: Iptables описание и работа с ним
published: true
date: 2023-12-07T08:52:38.736Z
tags: nat, межсетевой экран
editor: markdown
dateCreated: 2023-12-07T08:09:23.665Z
---

# Iptables

Это межсетевой экран
## Таблицы
В Iptables существуют по умолчанию 3 таблицы:
1. **filter**
2. **nat**
3. **mangle**
В таблице **filter** устанавливаются правила, которые принимаются самим хостом, или пакеты, которые маршрутизируются через устройство.
В таблице **nat** устанавливаются правила, которые взаимодействуют с пакетами, используя технологию NAT.
## Правила
Чтобы установить правила iptables используется команда:
`iptables`
Далее добавляются ключи `-S`,`-A` и т.д. для работы с iptables.
Рассмотрим как добавить правило PAT, наиболее популярное и востребованное в маршрутизатрах:
```bash
iptables -t nat -A POSTROUTING -o <Интерфейс> -j MASQUERADE
```
, где ключи
`-t` или `--table` - (Таблица) указание с какой таблицей работать
`-A` или `--Append` - (Добавить) команда на добавление правила в конец списка таблицы
`-o` или `--out-interface` - (Из-интерфейса) условие добавляемого правила, что правило будет работать только на пакеты, которые "вылетают" с интерфейса указанный после ключа
`-j` или `--jump` - (Прыжок) Попростому это указание какое активное действие применить
## Настройка iptables на RedOS
Для включение автозагрузки правил необходимо установить пакет iptables-serives:
```bash
dnf install iptables-services
```
> Вместе с iptables-servies устанавливаются блокирующие правила Reject в таблицу filter, их можно посмотреть
{.is-warning}

```bash
iptables -S
```
Чтобы удалить все правила в траблице filter, используем Flush:
```bash
iptables -F
```
Далее, включаем iptables в автозагрузку и дополнительно включаем --now
```bash
systemctl enable --now iptables
```
## Настройка PAT (MASQUERADE)
Чтобы установить правило MASQUERADE, Перегруженный NAT, или просто PAT, необходимо добавить соответствующие правило:
```bash
iptables -t nat -A POSTROUTING -o ens* -j MASQUERADE
```
Посмотреть данное правило в таблице nat можно следующей командой
```bash
iptables -t nat -S
```